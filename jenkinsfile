pipeline {

    parameters { 
        string defaultValue: 'main', name: 'branch', trim: true
        string defaultValue: 'maino', name: 'branchu', trim: true
     }

    environment {
         Myname = "Mohan"
         my_branch = "$branch"
    }

	agent none  
	stages {
		stage('BUILD') {
			parallel {
				stage('test on build') {
				
					agent { label 'slave2' }
			    		steps {
				   		 sh '''
						 pwd
						 sleep 5
					     echo "This is the fist stage: BUILD $my_branch $branchu"
				         '''
						}
                }
				
				
		
		
				stage('TEST on build 2') {
					agent { label 'master' }
			    		steps {
				    		sh '''
					    	pwd
					   		sleep 5
					    	echo "this is the second stage: TEST $Myname $my_branch"
				        	'''
						}	
			    }
			}		
		}
		
		stage('DEPLOY') {
			agent { label 'slave1' }
			steps {
				sh '''
					pwd
					sleep 5
					echo "This is the fist stage: DEPLOY $my_branch"
				'''
			}	
		}
	}
}